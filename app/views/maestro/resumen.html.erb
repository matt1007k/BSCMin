<% @title = "Resumen de resultados del BSC" %>

<nav class="breadcrumb" aria-label="breadcrumbs">
  <ul>
    <li> <%= link_to  "Dashboard", root_path %></li>
    <li class="is-active">      
      <a href="#" aria-current="page">Resumen de resultados del BSC</a>
    </li>
  </ul>
</nav>
  
<div class="columns">
  <div class="column is-flex-row-start">
    <%= link_to maestro_path, class: "button is-info" do %>
      <span class="icon">
        <i class="mdi mdi-arrow-left"></i>
      </span>
      <p> Ver maestro </p>      
    <% end %>
  </div>
</div>


<div class="columns">
  <div class="column">
      <div class="card margin-small shadow-cm">
        <div class="card-content">
          <p class="title is-4 has-text-centered">Resumen de resultados del BSC</p>
          <p class="subtitle is-6 has-text-centered">Resumen de resultados del BSC para cada indicador.</p>

          <div class="title is-4"> Perspectivas </div>

          
          <div class="columns">
            <div class="column">
                <div class="tabs is-centered is-boxed"  id="tab_header">
                  <ul>
                      <li class="item is-active" data-option="financiera-1">
                          <a>
                              <span class="icon is-small"><i class="mdi mdi-cash mdi-24px" aria-hidden="true"></i></span>
                              <span>Financiera</span>
                          </a>
                      </li>
                      <li class="item" data-option="cliente-1">
                          <a>
                              <span class="icon is-small"><i class="mdi mdi-account-group mdi-24px" aria-hidden="true"></i></span>
                              <span>Cliente</span>
                          </a>
                      </li>
                      <li class="item" data-option="procesos-1">
                          <a>
                              <span class="icon is-small"><i class="mdi mdi-message-processing mdi-24px" aria-hidden="true"></i></span>
                              <span>Procesos Internos</span>
                          </a>
                      </li>
                      <li class="item" data-option="aprendizaje-1">
                          <a>
                              <span class="icon is-small"><i class="mdi mdi-school mdi-24px" aria-hidden="true"></i></span>
                              <span>Aprendizaje y Crecimiento</span>
                          </a>
                      </li>
                  </ul>
                </div>


                <div class="box" id="tab_container">
                    <!-- Finaciera -->
                    <div class="container_item is-active" data-item="financiera-1">
                        <%-if  @objectivos.perspectiva(1).count > 0 %>
                        <table class="table is-fullwidth">
                            <thead>
                                <tr>
                                    <th>Objectivos Estratégico</th>
                                    <th>Indicador</th>
                                    <th>Meta</th>
                                    <th>Actual</th>
                                    <th>Semáforo</th>                              
                                </tr>
                            </thead>

                            <tbody>
                                <% @objectivos.perspectiva(1).each do |objectivo| %>
                                <tr> 
                                    <td><%= objectivo.content %></td>
                                    <% objectivo.indicators.each do |indicator| %>
                                        <tr> 
                                        <td></td>                                
                                        <td><%= indicator.indicador %></td>

                                        <% if indicator.fichas.count > 0 %>
                                            <% indicator.fichas.each do |ficha| %>                                        
                                                <td class="has-text-centered"><%= ficha.meta %></td>

                                                <% if  indicator.datos.count > 0 %>
                                                    <% @dato = indicator.datos.last %>
                                                    <td class="has-text-centered">
                                                        <% if indicator.tipo == "numero" %>
                                                            <%= indicator.datos.last.total %>
                                                        <% else %>
                                                            <%= indicator.datos.last.porcentaje %>%
                                                        <% end %>
                                                    </td>
                                                <% else %>
                                                    <td class="has-text-danger">No existe el año</td>
                                                <% end %>
                                                <%#= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                <% if  indicator.datos.count > 0 %>
                                                    <% @dato = indicator.datos.last %>
                                                    <td class="has-text-centered">
                                                        <% if indicator.tipo == "numero" %>
                                                            <% if @dato.total >= ficha.meta %>
                                                                <p class="has-text-success">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span> 
                                                                </p>
                                                            <% elsif @dato.total < ficha.meta && @dato.total >= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-warning">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.total < (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-danger">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% end %>
                                                        <% elsif indicator.tipo == "reducir" %>

                                                            <% if @dato.porcentaje.round <= ficha.meta %>
                                                                <p class="has-text-success">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.porcentaje.round > ficha.meta && @dato.porcentaje.round <= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-warning">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.porcentaje.round > (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-danger">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% end %>

                                                        <% else %>
                                                            <% if @dato.porcentaje.round >= ficha.meta %>
                                                            <p class="has-text-success">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% elsif @dato.porcentaje.round < ficha.meta && @dato.porcentaje.round >= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                            <p class="has-text-warning">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% elsif @dato.porcentaje.round < (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                            <p class="has-text-danger">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% end %>
                                                        <% end %>
                                                    </td>

                                                <% else %>
                                                    <td class="has-text-danger">No existe el año</td>
                                                <% end %>
                                            <% end %>
                                        <% else %>
                                            <td colspan="4">
                                                <h4 class="title is-4">
                                                    <span class="tag is-warning is-full-width">El indicador no tiene una ficha..!</span>
                                                </h4>  
                                            </td>
                                        <% end %>    
                                            
                                        </tr>
                                    <% end %>
                                    
                                    
                                </tr>
                                <% end %>
                            </tbody>
                        </table>
                        <hr>

                        <table class="table is-fullwidth">
                            <thead>
                                <tr>                              
                                    <th>Indicadores</th>
                                    <th class="has-background-success has-text-white">Verde</th>
                                    <th class="has-background-warning has-text-white">Amarillo</th>
                                    <th class="has-background-danger has-text-white">Rojo</th>                              
                                </tr>
                            </thead>
                            <tbody>
                            <% @objectivos.perspectiva(1).each do |objectivo| %>
                                
                                <% objectivo.indicators.each do |indicator| %>
                                <tr>                                
                                    <td><%= indicator.indicador %></td>

                                    <% if indicator.fichas.count > 0 %>
                                        <% indicator.fichas.each do |ficha| %>                                        
                                            <td class="has-text-centered">
                                                <%= ficha.verde %>
                                            </td>
                                            <td class="has-text-centered">
                                                <%= ficha.amarillo %>
                                            </td>
                                            <td class="has-text-centered">
                                                <%= ficha.rojo %>
                                            </td>
                                        <% end %>
                                    <% else %>
                                    <td colspan="3">
                                        <h4 class="title is-4">
                                            <span class="tag is-warning is-full-width">El indicador no tiene una ficha..!</span>
                                        </h4>  
                                    </td>
                                    <% end %>    
                                    
                                </tr>
                                <% end %>
                                    
                            <% end %>
                            </tbody>
                        </table>
                    <% else %>
                        <div class="notification is-warning is-fullwidth"> No hay registros ingresados!!!</div>
                    <% end %>
                    </div>
               
                    <!-- end Finaciera -->


                    <!-- Cliente -->
                    <div class="container_item" data-item="cliente-1">
                        <%if  @objectivos.perspectiva(2).count > 0 %>
                            <table class="table is-fullwidth">
                            <thead>
                                <tr>
                                    <th>Objectivos Estratégico</th>
                                    <th>Indicador</th>
                                    <th>Meta</th>
                                    <th>Actual</th>
                                    <th>Semáforo</th>                              
                                </tr>
                            </thead>

                            <tbody>
                                <% @objectivos.perspectiva(2).each do |objectivo| %>
                                <tr> 
                                    <td><%= objectivo.content %></td>
                                    <% objectivo.indicators.each do |indicator| %>
                                        <tr> 
                                        <td></td>                                
                                        <td><%= indicator.indicador %></td>

                                        <% if indicator.fichas.count > 0 %>
                                            <% indicator.fichas.each do |ficha| %>                                        
                                                <td class="has-text-centered"><%= ficha.meta %></td>

                                                <% if  indicator.datos.count > 0 %>
                                                    <% @dato = indicator.datos.last %>
                                                    <td class="has-text-centered">
                                                        <% if indicator.tipo == "numero" %>
                                                            <%= indicator.datos.last.total %>
                                                        <% else %>
                                                            <%= indicator.datos.last.porcentaje %>%
                                                        <% end %>
                                                    </td>
                                                <% else %>
                                                    <td class="has-text-danger">No existe el año</td>
                                                <% end %>
                                                <%#= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                <% if  indicator.datos.count > 0 %>
                                                    <% @dato = indicator.datos.last %>
                                                    <td class="has-text-centered">
                                                        <% if indicator.tipo == "numero" %>
                                                            <% if @dato.total >= ficha.meta %>
                                                                <p class="has-text-success">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span> 
                                                                </p>
                                                            <% elsif @dato.total < ficha.meta && @dato.total >= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-warning">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.total < (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-danger">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% end %>
                                                        <% elsif indicator.tipo == "reducir" %>

                                                            <% if @dato.porcentaje.round <= ficha.meta %>
                                                                <p class="has-text-success">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.porcentaje.round > ficha.meta && @dato.porcentaje.round <= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-warning">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.porcentaje.round > (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-danger">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% end %>

                                                        <% else %>
                                                            <% if @dato.porcentaje.round >= ficha.meta %>
                                                            <p class="has-text-success">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% elsif @dato.porcentaje.round < ficha.meta && @dato.porcentaje.round >= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                            <p class="has-text-warning">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% elsif @dato.porcentaje.round < (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                            <p class="has-text-danger">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% end %>
                                                        <% end %>
                                                    </td>

                                                <% else %>
                                                    <td class="has-text-danger">No existe el año</td>
                                                <% end %>
                                            <% end %>
                                        <% else %>
                                            <td colspan="4">
                                                <h4 class="title is-4">
                                                    <span class="tag is-warning is-full-width">El indicador no tiene una ficha..!</span>
                                                </h4>  
                                            </td>
                                        <% end %>    
                                            
                                        </tr>
                                    <% end %>
                                    
                                    
                                </tr>
                                <% end %>
                            </tbody>
                        </table>
                        <hr>

                        <table class="table is-fullwidth">
                            <thead>
                                <tr>                              
                                    <th>Indicadores</th>
                                    <th class="has-background-success has-text-white">Verde</th>
                                    <th class="has-background-warning has-text-white">Amarillo</th>
                                    <th class="has-background-danger has-text-white">Rojo</th>                              
                                </tr>
                            </thead>
                            <tbody>
                            <% @objectivos.perspectiva(2).each do |objectivo| %>
                                
                                <% objectivo.indicators.each do |indicator| %>
                                <tr>                                
                                    <td><%= indicator.indicador %></td>

                                    <% if indicator.fichas.count > 0 %>
                                        <% indicator.fichas.each do |ficha| %>                                        
                                            <td class="has-text-centered">
                                                <%= ficha.verde %>
                                            </td>
                                            <td class="has-text-centered">
                                                <%= ficha.amarillo %>
                                            </td>
                                            <td class="has-text-centered">
                                                <%= ficha.rojo %>
                                            </td>
                                        <% end %>
                                    <% else %>
                                    <td colspan="3">
                                        <h4 class="title is-4">
                                            <span class="tag is-warning is-full-width">El indicador no tiene una ficha..!</span>
                                        </h4>  
                                    </td>
                                    <% end %>    
                                    
                                </tr>
                                <% end %>
                                    
                            <% end %>
                            </tbody>
                        </table>
                        <% else %>
                            <div class="notification  is-warning is-fullwidth"> No hay registros ingresados!!!</div>
                        <% end %>
                    </div>
               
                    <!-- end cliente -->


                    <!-- Procesos -->
                
                
                    <div class="container_item" data-item="procesos-1">
                        <%-if  @objectivos.perspectiva(3).count > 0 %>
                        <table class="table is-fullwidth">
                            <thead>
                                <tr>
                                    <th>Objectivos Estratégico</th>
                                    <th>Indicador</th>
                                    <th>Meta</th>
                                    <th>Actual</th>
                                    <th>Semáforo</th>                              
                                </tr>
                            </thead>

                            <tbody>
                                <% @objectivos.perspectiva(3).each do |objectivo| %>
                                <tr> 
                                    <td><%= objectivo.content %></td>
                                    <% objectivo.indicators.each do |indicator| %>
                                        <tr> 
                                        <td></td>                                
                                        <td><%= indicator.indicador %></td>

                                        <% if indicator.fichas.count > 0 %>
                                            <% indicator.fichas.each do |ficha| %>                                        
                                                <td class="has-text-centered"><%= ficha.meta %></td>

                                                <% if  indicator.datos.count > 0 %>
                                                    <% @dato = indicator.datos.last %>
                                                    <td class="has-text-centered">
                                                        <% if indicator.tipo == "numero" %>
                                                            <%= indicator.datos.last.total %>
                                                        <% else %>
                                                            <%= indicator.datos.last.porcentaje %>%
                                                        <% end %>
                                                    </td>
                                                <% else %>
                                                    <td class="has-text-danger">No existe el año</td>
                                                <% end %>
                                                <%#= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                <% if  indicator.datos.count > 0 %>
                                                    <% @dato = indicator.datos.last %>
                                                    <td class="has-text-centered">
                                                        <% if indicator.tipo == "numero" %>
                                                            <% if @dato.total >= ficha.meta %>
                                                                <p class="has-text-success">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span> 
                                                                </p>
                                                            <% elsif @dato.total < ficha.meta && @dato.total >= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-warning">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.total < (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-danger">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% end %>
                                                        <% elsif indicator.tipo == "reducir" %>

                                                            <% if @dato.porcentaje.round <= ficha.meta %>
                                                                <p class="has-text-success">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.porcentaje.round > ficha.meta && @dato.porcentaje.round <= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-warning">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.porcentaje.round > (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-danger">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% end %>

                                                        <% else %>
                                                            <% if @dato.porcentaje.round >= ficha.meta %>
                                                            <p class="has-text-success">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% elsif @dato.porcentaje.round < ficha.meta && @dato.porcentaje.round >= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                            <p class="has-text-warning">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% elsif @dato.porcentaje.round < (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                            <p class="has-text-danger">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% end %>
                                                        <% end %>
                                                    </td>

                                                <% else %>
                                                    <td class="has-text-danger">No existe el año</td>
                                                <% end %>
                                            <% end %>
                                        <% else %>
                                            <td colspan="4">
                                                <h4 class="title is-4">
                                                    <span class="tag is-warning is-full-width">El indicador no tiene una ficha..!</span>
                                                </h4>  
                                            </td>
                                        <% end %>    
                                            
                                        </tr>
                                    <% end %>
                                    
                                    
                                </tr>
                                <% end %>
                            </tbody>
                        </table>
                        <hr>

                        <table class="table is-fullwidth">
                            <thead>
                                <tr>                              
                                    <th>Indicadores</th>
                                    <th class="has-background-success has-text-white">Verde</th>
                                    <th class="has-background-warning has-text-white">Amarillo</th>
                                    <th class="has-background-danger has-text-white">Rojo</th>                              
                                </tr>
                            </thead>
                            <tbody>
                            <% @objectivos.perspectiva(3).each do |objectivo| %>
                                
                                <% objectivo.indicators.each do |indicator| %>
                                <tr>                                
                                    <td><%= indicator.indicador %></td>

                                    <% if indicator.fichas.count > 0 %>
                                        <% indicator.fichas.each do |ficha| %>                                        
                                            <td class="has-text-centered">
                                                <%= ficha.verde %>
                                            </td>
                                            <td class="has-text-centered">
                                                <%= ficha.amarillo %>
                                            </td>
                                            <td class="has-text-centered">
                                                <%= ficha.rojo %>
                                            </td>
                                        <% end %>
                                    <% else %>
                                    <td colspan="3">
                                        <h4 class="title is-4">
                                            <span class="tag is-warning is-full-width">El indicador no tiene una ficha..!</span>
                                        </h4>  
                                    </td>
                                    <% end %>    
                                    
                                </tr>
                                <% end %>
                                    
                            <% end %>
                            </tbody>
                        </table> 
                        <% else %>
                            <div class="notification is-warning is-fullwidth"> No hay registros ingresados!!!</div>
                        <% end %>
                    </div>
                    <!-- end Procesos -->

                    <!-- Crecimiento -->
                    <div class="container_item" data-item="aprendizaje-1">
                        <%-if  @objectivos.perspectiva(4).count > 0 %>
                        <table class="table is-fullwidth">
                            <thead>
                                <tr>
                                    <th>Objectivos Estratégico</th>
                                    <th>Indicador</th>
                                    <th>Meta</th>
                                    <th>Actual</th>
                                    <th>Semáforo</th>                              
                                </tr>
                            </thead>

                            <tbody>
                                <% @objectivos.perspectiva(4).each do |objectivo| %>
                                <tr> 
                                    <td><%= objectivo.content %></td>
                                    <% objectivo.indicators.each do |indicator| %>
                                        <tr> 
                                        <td></td>                                
                                        <td><%= indicator.indicador %></td>

                                        <% if indicator.fichas.count > 0 %>
                                            <% indicator.fichas.each do |ficha| %>                                        
                                                <td class="has-text-centered"><%= ficha.meta %></td>

                                                <% if  indicator.datos.count > 0 %>
                                                    <% @dato = indicator.datos.last %>
                                                    <td class="has-text-centered">
                                                        <% if indicator.tipo == "numero" %>
                                                            <%= indicator.datos.last.total %>
                                                        <% else %>
                                                            <%= indicator.datos.last.porcentaje %>%
                                                        <% end %>
                                                    </td>
                                                <% else %>
                                                    <td class="has-text-danger">No existe el año</td>
                                                <% end %>
                                                <%#= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                <% if  indicator.datos.count > 0 %>
                                                    <% @dato = indicator.datos.last %>
                                                    <td class="has-text-centered">
                                                        <% if indicator.tipo == "numero" %>
                                                            <% if @dato.total >= ficha.meta %>
                                                                <p class="has-text-success">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span> 
                                                                </p>
                                                            <% elsif @dato.total < ficha.meta && @dato.total >= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-warning">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.total < (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-danger">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% end %>
                                                        <% elsif indicator.tipo == "reducir" %>

                                                            <% if @dato.porcentaje.round <= ficha.meta %>
                                                                <p class="has-text-success">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.porcentaje.round > ficha.meta && @dato.porcentaje.round <= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-warning">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% elsif @dato.porcentaje.round > (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                                <p class="has-text-danger">
                                                                    <span class="icon">
                                                                        <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                    </span>
                                                                </p>
                                                            <% end %>

                                                        <% else %>
                                                            <% if @dato.porcentaje.round >= ficha.meta %>
                                                            <p class="has-text-success">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% elsif @dato.porcentaje.round < ficha.meta && @dato.porcentaje.round >= (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                            <p class="has-text-warning">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% elsif @dato.porcentaje.round < (ficha.rojo[2]<<(if ficha.rojo[3].present? then ficha.rojo[3] else '' end)).to_i %>
                                                            <p class="has-text-danger">
                                                                <span class="icon">
                                                                    <i class="mdi mdi-checkbox-blank-circle"></i>
                                                                </span>
                                                            </p>
                                                            <% end %>
                                                        <% end %>
                                                    </td>

                                                <% else %>
                                                    <td class="has-text-danger">No existe el año</td>
                                                <% end %>
                                            <% end %>
                                        <% else %>
                                            <td colspan="4">
                                                <h4 class="title is-4">
                                                    <span class="tag is-warning is-full-width">El indicador no tiene una ficha..!</span>
                                                </h4>  
                                            </td>
                                        <% end %>    
                                            
                                        </tr>
                                    <% end %>
                                    
                                    
                                </tr>
                                <% end %>
                            </tbody>
                        </table>
                        <hr>

                        <table class="table is-fullwidth">
                            <thead>
                                <tr>                              
                                    <th>Indicadores</th>
                                    <th class="has-background-success has-text-white">Verde</th>
                                    <th class="has-background-warning has-text-white">Amarillo</th>
                                    <th class="has-background-danger has-text-white">Rojo</th>                              
                                </tr>
                            </thead>
                            <tbody>
                            <% @objectivos.perspectiva(4).each do |objectivo| %>
                                
                                <% objectivo.indicators.each do |indicator| %>
                                <tr>                                
                                    <td><%= indicator.indicador %></td>

                                    <% if indicator.fichas.count > 0 %>
                                        <% indicator.fichas.each do |ficha| %>                                        
                                            <td class="has-text-centered">
                                                <%= ficha.verde %>
                                            </td>
                                            <td class="has-text-centered">
                                                <%= ficha.amarillo %>
                                            </td>
                                            <td class="has-text-centered">
                                                <%= ficha.rojo %>
                                            </td>
                                        <% end %>
                                    <% else %>
                                    <td colspan="3">
                                        <h4 class="title is-4">
                                            <span class="tag is-warning is-full-width">El indicador no tiene una ficha..!</span>
                                        </h4>  
                                    </td>
                                    <% end %>    
                                    
                                </tr>
                                <% end %>
                                    
                            <% end %>
                            </tbody>
                        </table>
                        <% else %>
                            <div class="notification is-warning is-fullwidth"> No hay registros ingresados!!!</div>
                        <% end %>
                    </div>
                    
                    <!-- end Crecimiento -->  
              </div>



            </div>
          </div>          

          
      </div>
  </div> 

  
</div>

 

